//buildscript {
//    dependencies {
//        classpath 'com.h2database:h2:1.4.191'
//    }
//}

plugins {
//    id "org.flywaydb.flyway" version "4.0"
    id "org.flywaydb.flyway" version "3.2.1"
}

//flyway {
//    url = 'jdbc:h2:file:~/smart_finance/foobar'
//    user = 'root'
//}


//gradle flywayBaseline -i
//gradle flywayMigrate -i
flyway {
    url = 'jdbc:h2:file:~/smart_finance/finance'
    user = 'root'
    password = 'root'
    schemas = [/*,'FINANCE','TEST'*/ 'FOOBAR']
    table = '_SCHEMA_VERSION'
}

configurations {
    h2
}

dependencies {
    h2 'com.h2database:h2:1.4.191@jar'
    compile 'com.h2database:h2:1.4.191'
//    compile project (':utils')
}

jar {
    processResources {
        from(zipTree(configurations.h2.asPath))
//        from(zipTree(configurations.compile.asPath))
    }
    manifest {
        attributes(
                'Main-Class': 'org.h2.tools.Server'
        )
    }
    from('<path-to-props-file>') {
//        include 'database.properties'
        include '**/*'
        into('<target-path>')
    }
}

//test {
//    includes = ['**/H2DbTestSuite*'] as Set
    //excludes other tests, executes only tests from "includes" clause
//}

//task copyDbCreateScriptTask(type: Copy) {
//    description 'Copies the resource directory to the target directory.'
//    println "--->copy start"
//    from 'src/main/resources/DB_SCRIPT_CREATE.sql'
//    into 'build/resources/test'
//
//    println "--->copy end"
//}
//processTestResources.dependsOn copyDbCreateScriptTask